<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <base data-ice="baseUrl" href="../../">
  <title data-ice="title">nodeuii/app.js | vue-ssr-demo</title>
  <link type="text/css" rel="stylesheet" href="css/style.css">
  <link type="text/css" rel="stylesheet" href="css/prettify-tomorrow.css">
  <script src="script/prettify/prettify.js"></script>
  <script src="script/manual.js"></script>
</head>
<body class="layout-container" data-ice="rootContainer">

<header>
  <a href="./">Home</a>
  
  <a href="identifiers.html">Reference</a>
  <a href="source.html">Source</a>
  
  <div class="search-box">
  <span>
    <img src="./image/search.png">
    <span class="search-input-edge"></span><input class="search-input"><span class="search-input-edge"></span>
  </span>
    <ul class="search-result"></ul>
  </div>
</header>

<nav class="navigation" data-ice="nav"><div>
  <ul>
    
  <li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#config">config</a><span data-ice="kind" class="kind-function">F</span><span data-ice="name"><span><a href="function/index.html#static-function-index">index</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#middwares">middwares</a><span data-ice="kind" class="kind-variable">V</span><span data-ice="name"><span><a href="variable/index.html#static-variable-errorHandler">errorHandler</a></span></span></li>
<li data-ice="doc"><a data-ice="dirPath" class="nav-dir-path" href="identifiers.html#services">services</a><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/nodeuii/services/IndexService.js~IndexService.html">IndexService</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/nodeuii/services/QuestionService.js~QuestionService.html">QuestionService</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/nodeuii/services/TestService.js~TestService.html">TestService</a></span></span></li>
<li data-ice="doc"><span data-ice="kind" class="kind-class">C</span><span data-ice="name"><span><a href="class/nodeuii/services/UserService.js~UserService.html">UserService</a></span></span></li>
</ul>
</div>
</nav>

<div class="content" data-ice="content"><h1 data-ice="title">nodeuii/app.js</h1>
<pre class="source-code line-number raw-source-code"><code class="prettyprint linenums" data-ice="content">import Koa from &quot;koa&quot;;
import serve from &quot;koa-static&quot;;
import log4js from &apos;log4js&apos;;
import configure from &quot;./config&quot;;
import koaBody from &quot;koa-body&quot;;
import errorHandler from &quot;./middwares/errorHandler&quot;;
const { createContainer, Lifetime } = require(&apos;awilix&apos;);
const { loadControllers, scopePerRequest } = require(&apos;awilix-koa&apos;);
const app = new Koa();
//&#x521B;&#x5EFA;IOC&#x7684;&#x5BB9;&#x5668;
const container = createContainer();
//&#x6BCF;&#x4E00;&#x6B21;&#x7684;&#x8BF7;&#x6C42;&#x90FD;&#x662F;&#x4E00;&#x4E2A; new model
app.use(scopePerRequest(container));

app.use(koaBody());
//&#x88C5;&#x8F7D;&#x6240;&#x6709;&#x7684;models &#x5E76;&#x5C06;services&#x4EE3;&#x7801;&#x6CE8;&#x5165;&#x5230;controllers
container.loadModules([__dirname + &apos;/services/*.js&apos;], {
  formatName: &apos;camelCase&apos;,
  resolverOptions: {
    lifetime: Lifetime.SCOPED
  }
});
log4js.configure({
  appenders: { cheese: { type: &apos;file&apos;, filename: &apos;./logs/yd.log&apos; } },
  categories: { default: { appenders: [&apos;cheese&apos;], level: &apos;error&apos; } }
});
//&#x6B64;&#x5904;&#x9664;&#x4E86;&#x914D;&#x7F6E;config&#x5F00;&#x53D1;&#x9636;&#x6BB5;&#x8FD8;&#x6709;/__webpack_hmr
const config = configure(app);
const logger = log4js.getLogger(&apos;cheese&apos;);
errorHandler.error(app, logger);
//&#x6CE8;&#x518C;&#x6240;&#x6709;&#x7684;&#x8DEF;&#x7531;
app.use(loadControllers(__dirname + &apos;/controllers/*.js&apos;, { cwd: __dirname }));
app.use(serve(config.staticDir)); // &#x9759;&#x6001;&#x8D44;&#x6E90;&#x6587;&#x4EF6;
app.listen(config.port, () =&gt; {
  console.log(`ydSystem listening on ${config.port}`);
});
module.exports = app;
</code></pre>

</div>

<footer class="footer">
  Generated by <a href="https://esdoc.org">ESDoc<span data-ice="esdocVersion">(1.1.0)</span><img src="./image/esdoc-logo-mini-black.png"></a>
</footer>

<script src="script/search_index.js"></script>
<script src="script/search.js"></script>
<script src="script/pretty-print.js"></script>
<script src="script/inherited-summary.js"></script>
<script src="script/test-summary.js"></script>
<script src="script/inner-link.js"></script>
<script src="script/patch-for-local.js"></script>
</body>
</html>
